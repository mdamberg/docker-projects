<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Docker Todo List</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background: #000000;  /* Black background */
            min-height: 100vh;
            padding: 40px 0;
        }
        .todo-container {
            max-width: 600px;
            margin: 0 auto;
        }
        .todo-card {
            background: #1a1a1a;  /* Dark gray card */
            border: 2px solid #9b59b6;  /* Purple border */
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(155, 89, 182, 0.5);  /* Purple glow */
            padding: 30px;
        }
        .todo-item {
            background: #0a0a0a;  /* Darker black */
            border: 1px solid #00ffff;  /* Cyan border */
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.2s;
            color: #ffffff;  /* White text */
        }
        .todo-item:hover {
            transform: translateX(5px);
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.5);  /* Cyan glow on hover */
        }
        .todo-item.done {
            opacity: 0.6;
            text-decoration: line-through;
            border-color: #9b59b6;  /* Purple border when done */
        }
        .add-form {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        .add-form input {
            background: #1a1a1a;
            border: 1px solid #00ffff;
            color: #ffffff;
        }
        .add-form input:focus {
            background: #0a0a0a;
            border-color: #9b59b6;
            color: #ffffff;
            box-shadow: 0 0 10px rgba(155, 89, 182, 0.5);
        }
        .add-form select {
            background: #1a1a1a;
            border: 1px solid #00ffff;
            color: #ffffff;
        }
        .add-form select:focus {
            background: #0a0a0a;
            border-color: #9b59b6;
            color: #ffffff;
            box-shadow: 0 0 10px rgba(155, 89, 182, 0.5);
        }
        .add-form select option {
            background: #1a1a1a;
            color: #ffffff;
        }
        .btn-primary {
            background: #9b59b6;  /* Purple button */
            border-color: #9b59b6;
        }
        .btn-primary:hover {
            background: #8e44ad;
            border-color: #8e44ad;
        }
        .btn-outline-success {
            color: #00ffff;  /* Cyan */
            border-color: #00ffff;
        }
        .btn-outline-success:hover {
            background: #00ffff;
            color: #000000;
        }
        .btn-outline-danger {
            color: #ffff00;  /* Yellow */
            border-color: #ffff00;
        }
        .btn-outline-danger:hover {
            background: #ffff00;
            color: #000000;
        }
        h1 {
            color: #ffff00;  /* Yellow */
            text-align: center;
            margin-bottom: 30px;
            font-weight: bold;
            text-shadow: 0 0 20px rgba(255, 255, 0, 0.5);  /* Yellow glow */
        }
        hr {
            border-color: #9b59b6;  /* Purple divider */
            opacity: 0.3;
        }
        .text-muted {
            color: #00ffff !important;  /* Cyan for empty message */
        }
        .category-header {
            color: #ffff00;  /* Yellow category headers */
            font-size: 18px;
            font-weight: bold;
            margin-top: 20px;
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 2px solid #9b59b6;  /* Purple underline */
        }
        .category-header:first-of-type {
            margin-top: 0;
        }
        .priority-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: bold;
            margin-right: 8px;
        }
        .priority-high {
            background: rgba(255, 255, 0, 0.2);  /* Yellow background */
            border: 1px solid #ffff00;
            color: #ffff00;
        }
        .priority-medium {
            background: rgba(0, 255, 255, 0.2);  /* Cyan background */
            border: 1px solid #00ffff;
            color: #00ffff;
        }
        .priority-low {
            background: rgba(155, 89, 182, 0.2);  /* Purple background */
            border: 1px solid #9b59b6;
            color: #9b59b6;
        }
        .priority-select {
            transition: all 0.2s;
        }
        .priority-select:hover {
            opacity: 0.8;
            box-shadow: 0 0 5px currentColor;
        }
        .priority-select option {
            background: #1a1a1a;
            color: #ffffff;
        }
    </style>
</head>
<body>
    <div class="todo-container">
        <h1>üìù My Docker Todo List</h1>

        <!-- Metrics Dashboard -->
        <div class="todo-card mb-3">
            <h5 style="color: #00ffff; margin-bottom: 15px;">üìä Dashboard Metrics</h5>
            <div class="row text-center">
                <div class="col-6 col-md-3 mb-2 mb-md-0">
                    <div style="color: #9b59b6; font-size: 24px; font-weight: bold;">{{ metrics.total }}</div>
                    <div style="color: #00ffff; font-size: 12px;">Total Tasks</div>
                </div>
                <div class="col-6 col-md-3 mb-2 mb-md-0">
                    <div style="color: #ffff00; font-size: 24px; font-weight: bold;">{{ metrics.pending }}</div>
                    <div style="color: #00ffff; font-size: 12px;">Pending</div>
                </div>
                <div class="col-6 col-md-3 mb-2 mb-md-0">
                    <div style="color: #00ffff; font-size: 24px; font-weight: bold;">{{ metrics.completed }}</div>
                    <div style="color: #00ffff; font-size: 12px;">Completed</div>
                </div>
                <div class="col-6 col-md-3 mb-2 mb-md-0">
                    <div style="color: #9b59b6; font-size: 24px; font-weight: bold;">{{ metrics.completion_percentage }}%</div>
                    <div style="color: #00ffff; font-size: 12px;">Complete</div>
                </div>
            </div>
            {% if metrics.high_priority_pending > 0 %}
            <div class="mt-3 text-center" style="color: #ffff00;">
                üî¥ <strong>{{ metrics.high_priority_pending }}</strong> High Priority Task{{ 's' if metrics.high_priority_pending > 1 else '' }} Remaining
            </div>
            {% endif %}
        </div>

        <div class="todo-card">
            <form method="POST" action="/add" class="add-form">
                <input
                    type="text"
                    name="task"
                    class="form-control flex-grow-1"
                    placeholder="Enter a new task..."
                    required
                    autofocus
                >
                <select name="category" class="form-select" style="width: auto; background: #1a1a1a; border: 1px solid #00ffff; color: #ffffff;">
                    <option value="Docker">üê≥ Docker</option>
                    <option value="HomeAssistant">üè† HomeAssistant</option>
                    <option value="Remote Access">üåê Remote Access</option>
                    <option value="Scripting">üíª Scripting</option>
                    <option value="Monitoring">üìä Monitoring</option>
                    <option value="General" selected>üìù General</option>
                </select>
                <select name="priority" class="form-select" style="width: auto; background: #1a1a1a; border: 1px solid #00ffff; color: #ffffff;">
                    <option value="High">üî¥ High</option>
                    <option value="Medium" selected>üü° Medium</option>
                    <option value="Low">üü¢ Low</option>
                </select>
                <button type="submit" class="btn btn-primary">Add</button>
            </form>

            <hr class="my-4">

            {% if grouped_todos %}
                {% for category, category_todos in grouped_todos.items() %}
                <!-- Category Header -->
                <div class="category-header">
                    {% if category == 'Docker' %}
                        üê≥ Docker
                    {% elif category == 'HomeAssistant' %}
                        üè† HomeAssistant
                    {% elif category == 'Remote Access' %}
                        üåê Remote Access
                    {% elif category == 'Scripting' %}
                        üíª Scripting
                    {% elif category == 'Monitoring' %}
                        üìä Monitoring
                    {% else %}
                        üìù General
                    {% endif %}
                    <span style="color: #00ffff; font-size: 14px;">({{ category_todos|length }} task{{ 's' if category_todos|length > 1 else '' }})</span>
                </div>

                <!-- Todos in this category -->
                {% for todo in category_todos %}
                <div class="todo-item {% if todo.done %}done{% endif %}">
                    <div style="flex: 1;">
                        <form method="POST" action="/update_priority/{{ todo.id }}" style="display: inline-block; margin-right: 8px;">
                            <select name="priority"
                                    class="priority-select"
                                    onchange="this.form.submit()"
                                    style="background: #1a1a1a; border: 1px solid {% if todo.priority == 'High' %}#ffff00{% elif todo.priority == 'Medium' %}#00ffff{% else %}#9b59b6{% endif %}; color: {% if todo.priority == 'High' %}#ffff00{% elif todo.priority == 'Medium' %}#00ffff{% else %}#9b59b6{% endif %}; padding: 2px 4px; border-radius: 4px; font-size: 11px; font-weight: bold; cursor: pointer;">
                                <option value="High" {% if todo.priority == 'High' %}selected{% endif %}>üî¥ High</option>
                                <option value="Medium" {% if todo.priority == 'Medium' %}selected{% endif %}>üü° Medium</option>
                                <option value="Low" {% if todo.priority == 'Low' %}selected{% endif %}>üü¢ Low</option>
                            </select>
                        </form>
                        {% if todo.done %}
                            ‚úÖ {{ todo.task }}
                        {% else %}
                            ‚¨ú {{ todo.task }}
                        {% endif %}
                    </div>
                    <div>
                        <a href="/toggle/{{ todo.id }}" class="btn btn-sm btn-outline-success">
                            {% if todo.done %}Undo{% else %}Done{% endif %}
                        </a>
                        <a href="/delete/{{ todo.id }}" class="btn btn-sm btn-outline-danger">Delete</a>
                    </div>
                </div>
                {% endfor %}
                {% endfor %}
            {% else %}
                <p class="text-center text-muted mt-4">
                    No todos yet! Add one above to get started. üöÄ
                </p>
            {% endif %}
        </div>
    </div>
</body>
</html>